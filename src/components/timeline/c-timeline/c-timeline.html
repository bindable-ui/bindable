<!--
Copyright 2020, Verizon Media
Licensed under the terms of the MIT license. See the LICENSE file in the project root for license terms.
-->

<template>
    <c-spinner if.bind="isLoading"></c-spinner>
    <div
        if.bind="!isLoading"
        id.bind="id"
    >
        <div>
            <c-timeline-week-container
                days.bind="displayDays"
                day-click.call="dayClick(date)"
                time-view.bind="timeView"
                if.bind="timeView !== 'month'"
            >
                <div slot="hours">
                    <c-timeline-container>
                        <c-timeline-block
                            repeat.for="block of blocks"
                            time.one-time="block.time"
                        ></c-timeline-block>
                    </c-timeline-container>
                </div>
                <c-timeline-container
                    repeat.for="day of displayDays"
                    current-time-top.bind="day.currentTimeLine"
                    click.delegate="togglePopover($event, day)"
                    if.bind="!day.hidden"
                    loading.bind="day.isLoading || day.isRendering"
                >
                    <c-timeline-block repeat.for="block of day.blocks"></c-timeline-block>
                    <c-time-entry
                        repeat.for="entry of day.entries | transformEntries:day:pxPerMinute:timeView:tzOffset:zoomLevel & async:dayLoading(day)"
                        item.bind="entry"
                        class="timeline-week"
                    >
                    </c-time-entry>
                    <c-time-entry
                        item.bind="day.newItem"
                        view-model.ref="day.placeholderEntry"
                        if.bind="day.newItem"
                    >
                    </c-time-entry>
                </c-timeline-container>
            </c-timeline-week-container>
            <div if.bind="timeView === 'month'">
                month view
            </div>
        </div>
    </div>
</template>
